---
title: "AD1/CDD - Lab. 03 pt. 04"
author: "Francisco E. Júnior, André Goncalves"
date: "4 de junho de 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(boot)
library(readr)
library(here)
library(broom)
```

# Introdução
Iremos explorar um conjunto de dados da 1a. divisão do campeonato brasileiro de futebol de 2017, no intuito de responder algumas perguntas específicas.

# Perguntas
Para responder as perguntas abaixo, inicialmente iremos importar o dataset, assim:
```{r message=FALSE}
set.seed(1234)
jogos_brasileirao_2017 = readr::read_csv2(here::here("data/data.csv"))
```

## 1. Jogos aos domingos têm mais gols que jogos às quartas?
```{r}
```

## 2. Jogos onde há um vitorioso têm mais ou menos gols que empates?
Adicionando uma coluna para identificar se um determinado jogo foi empate ou não:
```{r}
foi_empate = function(col) {col == 'Empate'}

jogos_brasileirao_2017 = jogos_brasileirao_2017 %>% mutate(Empate = foi_empate(`Vencedor Estado`))
```

Agora, calculando a média na nossa amostra agrupando pela nova coluna:
```{r}
theta_diff_gols = function(d, i) {
    gols = d %>%
        slice(i) %>% 
        group_by(Empate) %>%
        summarise(media_gols = mean(gols))
    
    media_gols_vitoriosos = gols %>% filter(Empate == FALSE) %>% pull(media_gols)
    media_gols_empates = gols %>% filter(Empate == TRUE) %>% pull(media_gols)
    
    media_gols_vitoriosos - media_gols_empates
}

theta_c_gols = theta_diff_gols(jogos_brasileirao_2017, 1:NROW(jogos_brasileirao_2017))

theta_c_gols
```
Na nossa amostra, temos uma média de 0.56181 gols a mais nos jogos que terminaram com vitoriosos quando comparado com jogos que terminaram em empate.

```{r}
jogos_brasileirao_2017 %>% 
    boot(statistic = theta_diff_gols, R = 4000) %>% 
    tidy(conf.level = 0.95, 
         conf.int = TRUE)
```
Podemos afirmar com 95% de confiança que nos jogos do campeonato brasileiro que jogos que terminam com um vitorioso tem mails gols (no intervalo [0.237, 0.9]) que jogos que terminam empatados. Essa variação é pouco significativa (menor que um gol).
